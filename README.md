# Квиз-бот для ВК и Telegram

Учебный проект курсов веб-разработчиков [dvmn](https://dvmn.org).  
[Ссылка на группу ВК с подключенным ботом](https://vk.com/club210812774).  
Бот в телеграм: @devman_quiz_bot_bot.

## Установка
Вам понадобится установленный Python 3.8+ и git.

Склонируйте репозиторий:
```bash
git clone git@github.com:IlyaG96/tg_vk_quiz.git
```

Создайте в этой папке виртуальное окружение:
```bash
cd tg_vk_quiz
python3 -m venv env
```

Активируйте виртуальное окружение и установите зависимости:
```bash
source env/bin/activate
pip install -r requirements.txt
```

## Настройка перед использованием

### Переменные окружения

Перед использованием вам необходимо заполнить .env.example файл или иным образом передать переменные среды:
* TELEGRAM_TOKEN - токен бота Telegram. Можно получить у [@BotFather](https://t.me/BotFather).
* REDIS_HOST - публичный адрес базы данных Redis
* VK_TOKEN - токен группы ВК (в меню работа с API)
* REDIS_PORT - порт БД Redis
* REDIS_PASSWORD - пароль БД Redis
* PATH_TO_QUESTIONS - путь до папки с вопросами (`/questions` по умолчанию)


## Использование


### ВК-бот
Для старта вк-бота, запустите скрипт:
```bash
$ python vk_bot
```

### Телеграм-бот

Для старта телеграм-бота, запустите скрипт:
```bash
$ python tg_bot
```

### redis_db.py, compare_phrases.py, load_questions.py
<details>
<summary>Открыть описание</summary>

#### redis_db.py
Используются для работы с базой данных Redis и для сравнения фраз соответственно.

Структура базы данных:
```python
{'user': {'question_num': '1', 'scores': '0'}}
```
В качестве ключа user используется или `telegram_id`, или `vk_id`

#### compare_phrases.py 
Использует два алгоритма для сравнения фраз.  
Если хотя бы один из них показывает более 50% совпадения, ответ засчитывается.

#### load_questions.py

Скрипт для создания словаря с вопросами
</details>

### questions

Папка с вопросами. Важное требование к структуре файла с вопросами:
- Вопрос должен следовать после строки, содержащей `Вопрос`
- Ответ должен следовать после строки, содержащей `Ответ:`
- Желательно, чтобы ответ был односложным и однозначным. Так, очень длинное предложение подразумевает множество вариаций, которые система сравнения пока не в силах учесть


